# ScaenaHub 実装タスクリスト

## 実装計画

以下のタスクは、テスト駆動開発を基本とし、段階的に機能を構築していきます。各タスクは前のタスクの成果物を基盤として進めます。

- [x] 1. プロジェクト基盤とコア設定の構築




  - Node.js/Express.js プロジェクトの初期化とTypeScript設定
  - 基本的なフォルダ構造とlinting設定を作成
  - 環境変数管理とSupabase接続設定を実装
  - _要件: 10.1, 10.2_

- [x] 2. データベーススキーマとモデルの実装





  - Supabaseデータベーススキーマ（users, roles, channels, messages）を作成
  - TypeScriptでのデータモデル定義とバリデーション関数を実装
  - データベース接続サービスとGoogle Sheetsフォールバック機能を実装
  - _要件: 10.2, 10.3_

- [x] 3. 認証システムの実装



  - JWT認証サービス（ログイン、登録、トークン検証）を実装
  - 管理者キー検証機能付きユーザー登録APIを作成
  - 認証ミドルウェアとセッション管理を実装
  - 認証関連のユニットテストを作成
  - _要件: 1.1, 1.2, 1.3, 1.4_


- [x] 4. ユーザー・ロール管理システムの実装














  - 複数ロール対応のユーザー管理APIを実装
  - ロール作成・編集・削除機能を実装
  - 権限チェック機能とミドルウェアを作成
  - ユーザー・ロール管理のテストを作成
  - _要件: 5.1, 5.2, 5.3_

- [x] 5. チャンネル管理システムの実装








  - チャンネル作成・編集・削除APIを実装
  - チャンネル権限設定機能（ロールベースアクセス制御）を実装
  - チャンネル一覧取得とフィルタリング機能を実装
  - チャンネル管理のテストを作成
  - _要件: 2.1, 5.2_

- [x] 6. メッセージシステムの基本実装





  - メッセージ投稿・編集・削除APIを実装
  - メンション機能（@ユーザー名）を実装
  - メッセージ履歴取得とページネーション機能を実装
  - メッセージ関連のテストを作成
  - _要件: 2.2, 2.4, 3.2, 3.3, 3.4_

- [x] 7. リアクション・スレッド機能の実装


  - メッセージリアクション追加・削除機能を実装
  - スレッド作成・返信機能を実装
  - リアクション・スレッドのデータ管理を実装
  - 関連機能のテストを作成
  - _要件: 2.3, 3.1_

- [x] 8. Socket.ioリアルタイム通信の実装
  - Socket.ioサーバー設定とイベントハンドラーを実装
  - リアルタイムメッセージ配信機能を実装
  - メンション通知とリアクション同期機能を実装
  - WebSocket認証とエラーハンドリングを実装
  - _要件: 2.2, 2.4, 3.1_

- [x] 9. Google Drive ファイル管理の実装
  - Google Drive API統合とサービスアカウント認証を実装
  - ファイルアップロード・ダウンロード機能を実装
  - ファイルサイズ・種別制限とバリデーションを実装
  - ファイル管理のテストを作成
  - _要件: 4.1, 4.2, 4.3_

- [ ] 10. Google Document 台本ビュー機能の実装



  - Google Docs API統合を実装
  - 台本データ取得・パース機能を実装
  - 台本表示用のデータ変換処理を実装
  - 台本ビュー機能のテストを作成
  - _要件: 6.1, 6.2_

- [x] 11. 自動バックアップシステムの実装




  - データベースバックアップ機能（Google Drive + GitHub）を実装
  - スケジュール実行機能（cron）を実装
  - バックアップ失敗時の通知機能を実装
  - 手動バックアップ実行APIを実装
  - _要件: 7.1, 7.2, 7.3_

- [x] 12. React.js フロントエンド基盤の構築




  - React.js + TypeScript + Tailwind CSS プロジェクトを初期化
  - ルーティング設定とレイアウトコンポーネントを作成
  - API通信サービスとSocket.io統合を実装
  - 認証状態管理（Context API）を実装
  - _要件: 8.1, 8.2, 8.3, 8.4_

- [x] 13. 認証画面の実装



  - ログインフォームコンポーネントを作成
  - ユーザー登録フォーム（管理者キー入力付き）を作成
  - 認証エラーハンドリングとバリデーション表示を実装
  - iPad、スマホ対応のタッチ操作最適化を実装
  - _要件: 1.1, 1.2, 1.3, 1.4, 8.1, 8.4_

- [x] 14. メインチャット画面の実装



  - チャンネル一覧サイドバーコンポーネントを作成
  - メッセージ一覧表示コンポーネントを作成
  - メッセージ入力フォームとリアルタイム送信を実装
  - iPad、スマホ対応のレスポンシブデザインを実装
  - _要件: 2.1, 2.2, 8.1, 8.2, 8.3_

- [x] 15. メッセージ機能の完全実装




  - メンション機能（@ユーザー名の自動補完）を実装
  - リアクションピッカーとリアクション表示を実装
  - メッセージ編集・削除UI（権限チェック付き）を実装
  - スレッド表示・返信機能を実装
  - _要件: 2.3, 2.4, 3.1, 3.2, 3.3, 3.4_

- [x] 16. ファイル共有機能の実装



  - ファイルアップロードコンポーネント（ドラッグ&ドロップ対応）を作成
  - ファイルプレビュー・ダウンロード機能を実装
  - アップロード進捗表示とエラーハンドリングを実装
  - iPad、スマホ対応のファイル選択UIを実装
  - _要件: 4.1, 4.2, 4.3, 8.1, 8.4_

- [ ] 17. 台本ビュー画面の実装


  - 台本表示コンポーネント（読みやすいレイアウト）を作成
  - 台本データの自動更新機能を実装
  - iPad、スマホ対応の台本閲覧UIを実装
  - 台本ビューのナビゲーション機能を実装
  - _要件: 6.1, 6.2, 8.1, 8.2, 8.3_

- [x] 18. 管理者画面などの実装









  - ユーザー管理画面（一覧・ロール編集）を作成
  - ロール管理画面（作成・編集・権限設定）を作成
  - チャンネル権限設定画面を作成
  - システム設定・バックアップ管理画面を作成
  - ユーザー全員が確認できる、ロール割り当て一覧を作成
  - ユーザーのプロフィールビュー（ロールなどが確認可能）を作成
  - _要件: 5.1, 5.2, 5.3, 7.3, 9.1, 9.2, 9.3_

- [ ] 19. 通知システムの実装
  - メンション通知の表示機能を実装
  - システム通知（バックアップ失敗等）の表示を実装
  - 通知の既読管理機能を実装
  - iPad、スマホ対応の通知UI（プッシュ通知風）を実装
  - _要件: 2.4, 7.2_

- [ ] 20. エラーハンドリングとフォールバック機能の実装
  - グローバルエラーハンドラーとエラー境界を実装
  - データベース障害時のGoogle Sheetsフォールバック機能を実装
  - ネットワーク障害時の自動再接続機能を実装
  - ユーザーフレンドリーなエラーメッセージ表示を実装
  - _要件: 10.2, 10.3_

- [ ] 21. パフォーマンス最適化とテスト
  - メッセージ一覧の仮想スクロール実装
  - 画像・ファイルの遅延読み込み実装
  - Socket.io接続の最適化とメモリリーク対策
  - 60人同時接続でのパフォーマンステストを実行
  - _要件: 10.3, 8.2_

- [ ] 22. セキュリティ強化とバリデーション
  - 入力サニタイゼーションとXSS対策を実装
  - レート制限機能（メッセージ送信・ファイルアップロード）を実装
  - CSRF対策とセキュリティヘッダー設定を実装
  - セキュリティテストを実行
  - _要件: 3.4, 4.3_

- [ ] 23. デプロイメント設定とCI/CD
  - Render.com用のデプロイ設定を作成
  - 環境変数設定とプロダクション最適化を実装
  - GitHub Actions CI/CDパイプラインを設定
  - デプロイメントテストを実行
  - _要件: 10.1_

- [ ] 24. 統合テストとE2Eテスト
  - 主要ユーザーフローのE2Eテストを作成
  - API統合テストの完全実装
  - iPad実機でのテスト実行
  - パフォーマンス・負荷テストの実行
  - _要件: 全要件の統合テスト_

- [ ] 25. ドキュメント作成と運用準備
  - ユーザー向け操作マニュアルを作成
  - 管理者向け運用ガイドを作成
  - Supabase・Google Services設定手順書を作成
  - トラブルシューティングガイドを作成
  - _要件: 9.1, 9.2, 9.3_